#!/usr/bin/php
<?php
require getcwd() . '/vendor/autoload.php';

if (is_file(getcwd() . '/.env')) {
    $dotenv = \Dotenv\Dotenv::create(getcwd().'/');
    $dotenv->load();
}

use Symfony\Component\Console\Application;
use extas\components\SystemContainer;
use extas\interfaces\plugins\IPluginRepository;
use extas\components\Plugins;

$application = new Application();
$application->setName(PHP_EOL . ' Extas installer');
$application->setVersion('2.0');
$application->add(new \extas\commands\InitCommand());
$application->add(new \extas\commands\InstallCommand());
$application->add(new \extas\commands\UninstallCommand());

if (SystemContainer::hasItem(IPluginRepository::class)) {
    foreach (Plugins::byStage('extas.installer.command') as $plugin) {
        $application->add($plugin());
    }
}

$application->run();
